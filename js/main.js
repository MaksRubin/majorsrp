let packageId=-1;function onPaymentRequestSucceed(json){try{json=JSON.parse(json);}catch(e){}
if(json.status=="success"){location.href=json.redirect_url;}else if(json.status=="warning"){SendNotify(json.header,json.message,json.status,json.url);}}
$(function(){$('#buyAction').click(function(e){const money=$('#sum').val();const nickname=$('#nickname').val();const system=$('input[name="system"]:checked').val();console.log({money,nickname,system});$.ajax({type:"POST",url:`/api/${system=="anypay"?"a":""}payment/redirectUrl`,data:JSON.stringify(packageId!==-1?{package_id:packageId,}:{nickname,money,}),contentType:'application/json',cache:false,processData:false,success:onPaymentRequestSucceed});});$('#donate_go').click(function(e){const money=$('#sum').val();const nickname=$('#nickname').val();const server=$('#server').val();if(money&&nickname&&server)
$('#policyModal').modal('toggle');});$('.mobile_nav').click(function(e){e.preventDefault();$('html').toggleClass('no_scroll');$(this).toggleClass('mobile_nav-active');$('.img-jackpot').toggleClass('hide');$('.nav_list').toggleClass('active');});$('.nav_list a').click(function(e){if($('.nav_list').hasClass('active')){$('html').toggleClass('no_scroll');$(this).toggleClass('mobile_nav-active');$('.img-jackpot').toggleClass('hide');$('.nav_list').toggleClass('active');}else{var id=$(this).attr('href'),top=$(id).offset().top;$('body,html').animate({scrollTop:top},1500);}});$('.vip_block').click(function(e){var id=$(this).attr('href'),top=$(id).offset().top;$('body,html').animate({scrollTop:top},1500);});$('.profile_section .content_list').slick({arrows:false,adaptiveHeight:true,slidesToShow:1,slidesToScroll:1,swipe:false});$('.toggleUploadMusic').click(function(e){$('.form_upload_music').toggleClass('active');});$('.profile_section .tabs_block .header li[data-slide], .profile_section .tabs_block .header .dropdown-item[data-slide]').click(function(e){var tabcontent=$(".profile_section li");for(i=0;i<tabcontent.length;i++){$(tabcontent[i]).removeClass('active');}
e.preventDefault();var slideno=$(this).data('slide');$('.profile_section .content_list').slick('slickGoTo',slideno-1);$(this).addClass('active');});$(".selectBox").click(function(){$(".selectBoxMenu").toggleClass("show");});$.ajaxSetup({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')}});$(".selectBoxMenu li").click(function(){if($(this).children('.checkbox').hasClass("fill")){$(".map_icon[data-type='"+$(this).children('.checkbox').attr("data-type")+"']").hide();}else{$(".map_icon[data-type='"+$(this).children('.checkbox').attr("data-type")+"']").show();}
$(this).children('.checkbox').toggleClass('fill');});});var app=new Vue({el:'#app_block',data:{},methods:{onSubmit:function(event){var form=event.target;$(form).find('button').attr('disabled',true);$.ajax({type:$(form).attr('method'),url:$(form).attr('action'),data:new FormData(form),contentType:false,cache:false,processData:false,success:function(result){json=jQuery.parseJSON(result);SendNotify(json.header,json.message,json.status,json.url);if(json.status!='success')$(form).find('button').attr('disabled',false);}});},buyPackage:function(id){packageId=id;$('#policyModal').modal('toggle');}}});function SendNotify(title,message,type,link=""){var e=$.notify({title:title,message:message,},{type:type,allow_dismiss:true,newest_on_top:false,mouse_over:true,showProgressbar:false,spacing:10,timer:2000,placement:{from:'bottom',align:'right'},offset:{x:30,y:30},delay:1000,z_index:10000,animate:{enter:"animated fadeInDown",exit:"animated fadeOutDown"}});$('.alert[data-notify] .close').html('');$('.alert[data-notify]').removeClass('col-xs-11 col-sm-4');if(link)setTimeout(()=>RedirectNotify(link),1000);}
function RedirectNotify(link){var e=$.notify({message:'Переход на другую страницу..',url:link},{type:'info',allow_dismiss:true,newest_on_top:false,mouse_over:true,showProgressbar:true,spacing:10,timer:2000,placement:{from:'bottom',align:'right'},offset:{x:30,y:30},delay:1000,z_index:10000,animate:{enter:"animated fadeInDown",exit:"animated fadeOutDown"}});setTimeout(()=>window.location.href=link,3000);$('.alert[data-notify] .close').html('');$('.alert[data-notify]').removeClass('col-xs-11 col-sm-4');}